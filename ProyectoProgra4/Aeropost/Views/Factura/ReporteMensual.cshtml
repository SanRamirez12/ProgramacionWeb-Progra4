@using System.Globalization
@model IEnumerable<Aeropost.Models.Factura>
@{
    ViewData["Title"] = "Reporte Mensual";
    var us = CultureInfo.CreateSpecificCulture("en-US"); // $ y punto decimal
    int anio = ViewBag.Anio ?? DateTime.Now.Year;
    int mes = ViewBag.Mes ?? DateTime.Now.Month;
    int cantidad = ViewBag.Cantidad ?? (Model?.Count() ?? 0);
    decimal total = ViewBag.Total ?? (Model?.Sum(f => f.MontoTotal) ?? 0m);
}

<!-- Contenedor principal usando el diseño existente -->
<div class="clientes-container">
    <div class="clientes-wrapper">
        <!-- Título con estilo moderno -->
        <h1 class="clientes-title">Reporte Mensual</h1>

        <!-- Formulario de filtro -->
        <div class="modern-card">
            <div class="modern-card-body">
                <form asp-action="ReporteMensual" method="get" class="client-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="anio" class="form-label">Año</label>
                            <input id="anio" name="anio" type="number" class="form-input" value="@anio" min="2000" max="2100" />
                        </div>
                        <div class="form-group">
                            <label for="mes" class="form-label">Mes</label>
                            <input id="mes" name="mes" type="number" class="form-input" value="@mes" min="1" max="12" />
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn-submit" type="submit">
                            Generar Reporte
                        </button>
                        <a asp-action="Index" class="btn-cancel">
                            Volver
                        </a>
                    </div>
                </form>
            </div>
        </div>

        @if (Model != null && Model.Any())
        {
            <!-- Resumen del Período -->
            <div class="modern-card" style="margin-bottom: 2rem; background: rgba(16, 185, 129, 0.05);">
                <div class="modern-card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <h5 style="color: #1e3a8a; margin-bottom: 1rem; font-weight: 600;">Período de Consulta</h5>
                            <div style="margin-bottom: 0.5rem;">
                                <strong>Mes:</strong> @mes.ToString("00")
                            </div>
                            <div>
                                <strong>Año:</strong> @anio
                            </div>
                        </div>
                        <div class="form-group">
                            <h5 style="color: #1e3a8a; margin-bottom: 1rem; font-weight: 600;">Resumen del Período</h5>
                            <div style="margin-bottom: 0.5rem;">
                                <strong>Total de facturas:</strong> @cantidad
                            </div>
                            <div>
                                <strong>Total facturado:</strong> <span style="color: #059669; font-weight: 600; font-size: 1.125rem;">@total.ToString("C2", us)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabla de Facturas -->
            <div class="modern-card">
                <div class="modern-card-body" style="padding: 0;">
                    <div style="overflow-x: auto;">
                        <table class="modern-table" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th style="text-align: left;">Fecha de Entrega</th>
                                    <th style="text-align: left;">Número de Tracking</th>
                                    <th style="text-align: left;">Cédula del Cliente</th>
                                    <th style="text-align: right;">Monto Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var f in Model)
                                {
                                    <tr>
                                        <td>@f.FechaEntrega.ToString("dd/MM/yyyy")</td>
                                        <td>@f.NumeroTracking</td>
                                        <td>@f.CedulaCliente</td>
                                        <td style="text-align: right; font-weight: 600; color: #059669;">
                                            @f.MontoTotal.ToString("C2", us)
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="modern-card">
                <div class="modern-card-body" style="text-align: center; padding: 3rem 2rem;">
                    <p style="color: #6b7280; font-size: 1.125rem; margin: 0;">
                        No hay facturas para el período seleccionado.
                    </p>
                </div>
            </div>
        }
    </div>
</div>